"use strict";(self.webpackChunksermas_eu_github_io=self.webpackChunksermas_eu_github_io||[]).push([[7382],{4891:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"getting-started/create-application","title":"Create an application","description":"To create an application, we are going to use the SERMAS CLI","source":"@site/docs/getting-started/create-application.md","sourceDirName":"getting-started","slug":"/getting-started/create-application","permalink":"/docs/getting-started/create-application","draft":false,"unlisted":false,"editUrl":"https://github.com/sermas-eu/sermas-eu.github.io/sidebar.ts/docs/getting-started/create-application.md","tags":[],"version":"current","sidebarPosition":0.002,"frontMatter":{"sidebar_position":0.002},"sidebar":"tutorialSidebar","previous":{"title":"System setup","permalink":"/docs/getting-started/system-setup"},"next":{"title":"Applications","permalink":"/docs/category/applications"}}');var a=n(4848),t=n(8453);const r={sidebar_position:.002},o="Create an application",l={},c=[{value:"Create a command alias",id:"create-a-command-alias",level:2},{value:"On Windows",id:"on-windows",level:3},{value:"On Linux",id:"on-linux",level:3},{value:"Solving permissions issues",id:"solving-permissions-issues",level:4},{value:"Login with the admin user",id:"login-with-the-admin-user",level:2},{value:"Create an application template",id:"create-an-application-template",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"create-an-application",children:"Create an application"})}),"\n",(0,a.jsxs)(s.p,{children:["To create an application, we are going to use the ",(0,a.jsx)(s.a,{href:"../sermas-cli/setup",children:"SERMAS CLI"})]}),"\n",(0,a.jsxs)(s.p,{children:["Let's create a commodity alias for ",(0,a.jsx)(s.code,{children:"sermas-cli"}),". It uses our same system user ID to avoid file permission issues."]}),"\n",(0,a.jsxs)(s.p,{children:["If you're using Windows make sure to install and use WSL (",(0,a.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/windows/wsl/install",children:"Microsoft's tutorial to install WSL"}),")"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"NOTE"})," We assume you can use docker with your user. Add ",(0,a.jsx)(s.code,{children:"sudo"})," to the command if it is not the case e.g. ",(0,a.jsx)(s.code,{children:"sudo docker ps"})]}),"\n",(0,a.jsx)(s.h2,{id:"create-a-command-alias",children:"Create a command alias"}),"\n",(0,a.jsxs)(s.p,{children:["The alias ",(0,a.jsx)(s.code,{children:"sermas-cli"})," will be used for all following commands"]}),"\n",(0,a.jsx)(s.h3,{id:"on-windows",children:"On Windows"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:'alias "sermas-cli=docker compose run --rm -it cli"\n'})}),"\n",(0,a.jsx)(s.h3,{id:"on-linux",children:"On Linux"}),"\n",(0,a.jsx)(s.p,{children:"On Linux we must run docker commands using our user id (not root) in order to own the generated files and folders."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:'alias "sermas-cli=docker compose run --user `id -u` --rm -it cli"\n'})}),"\n",(0,a.jsx)(s.h4,{id:"solving-permissions-issues",children:"Solving permissions issues"}),"\n",(0,a.jsxs)(s.p,{children:["It may happens that some directories get created with ",(0,a.jsx)(s.code,{children:"root"})," ownership by docker and this causes your user to not being able to access them anymore."]}),"\n",(0,a.jsx)(s.p,{children:"You may notice errors like those"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"error: Failed to write file /data/cli.json: EACCES: permission denied, open '/data/cli.json'"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"error: Failed to create template EACCES: permission denied, mkdir '/apps/myapp'"})}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"To fix those errors, set ownership of CLI related folders to your current user. E.g."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"sudo chown -R `id -u` ./apps ./data/cli\n"})}),"\n",(0,a.jsx)(s.h2,{id:"login-with-the-admin-user",children:"Login with the admin user"}),"\n",(0,a.jsxs)(s.p,{children:["Use the following command and use the configured password (",(0,a.jsx)(s.code,{children:"admin"})," is the default)."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"sermas-cli auth login admin\n"})}),"\n",(0,a.jsx)(s.h2,{id:"create-an-application-template",children:"Create an application template"}),"\n",(0,a.jsx)(s.p,{children:"The CLI uses a directory structure to create and keep updated the application definition. It allows to specify configuration and assets to be uploaded."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"sermas-cli app init /apps/myapp\n"})}),"\n",(0,a.jsx)(s.p,{children:"The resulting structure is similar to the following"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"apps/\n\u2514\u2500\u2500 myapp\n    \u251c\u2500\u2500 app.yaml\n    \u251c\u2500\u2500 modules.yaml\n    \u251c\u2500\u2500 repository\n    \u2502   \u251c\u2500\u2500 avatars\n    \u2502   \u2502   \u2514\u2500\u2500 anna.yaml\n    \u2502   \u251c\u2500\u2500 backgrounds\n    \u2502   \u2502   \u251c\u2500\u2500 milkyway.jpg\n    \u2502   \u2502   \u2514\u2500\u2500 milkyway.yaml\n    \u2502   \u251c\u2500\u2500 documents\n    \u2502   \u2502   \u251c\u2500\u2500 about.txt\n    \u2502   \u2502   \u251c\u2500\u2500 about.yaml\n    \u2502   \u2502   \u251c\u2500\u2500 toolkit.txt\n    \u2502   \u2502   \u2514\u2500\u2500 toolkit.yaml\n    \u2502   \u2514\u2500\u2500 robots\n    \u2502       \u2514\u2500\u2500 my-agv.yaml\n    \u251c\u2500\u2500 repository.yaml\n    \u251c\u2500\u2500 settings.yaml\n    \u251c\u2500\u2500 tools.yaml\n"})}),"\n",(0,a.jsx)(s.p,{children:"We'll learn more about the app structure later."}),"\n",(0,a.jsx)(s.p,{children:"Let's create the application in the SERMAS API with"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sh",children:"sermas-cli app save /apps/myapp\n"})}),"\n",(0,a.jsx)(s.p,{children:"You should see a confirmation message."}),"\n",(0,a.jsxs)(s.p,{children:["The newly created app can be used in the kiosk app on ",(0,a.jsx)(s.a,{href:"http://localhost:8080",children:"http://localhost:8080"})]}),"\n",(0,a.jsxs)(s.p,{children:["In case you received an error, check for errors in the logs with ",(0,a.jsx)(s.code,{children:"docker compose logs api"}),"."]})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var i=n(6540);const a={},t=i.createContext(a);function r(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);